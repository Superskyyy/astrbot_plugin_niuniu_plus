# Changelog

## [v2.0.5] - 2026-01-22

### 机制调整
- **牛牛寄生**: 改为指定目标寄生（原为随机）
  - 用法：`牛牛购买 18 @目标`
  - 不能寄生自己
  - 目标必须已注册牛牛

---

## [v2.0.4] - 2026-01-22

### 新增功能
- **牛牛寄生** (150金币): 在指定群友身上种下寄生牛牛
  - 触发条件：宿主增长超过自身绝对值长度的 5% 时
  - 抽取效果：抽取宿主 5% 绝对值长度 + 5% 硬度给受益者
  - 持续存在直到宿主购买驱牛药
  - 单一寄生机制：新寄生覆盖旧寄生（有专属文案）
  - 支持链式反应（A→B→C递归触发）

- **驱牛药** (75金币): 清除自己身上的寄生牛牛
  - 显示被清除的寄生牛牛来源

### 显示优化
- 我的牛牛：显示 `🦠【寄】寄生牛牛来自：{受益者名}`
- 牛牛排行榜：带寄生的用户显示 `【寄】` 标记
- 牛牛背包：显示寄生状态和清除提示

### 触发场景
寄生牛牛在以下场景检查触发：
- 打胶增益
- 比划获胜增益
- 混沌风暴增益
- 商城道具增益

---

## [v2.0.3] - 2026-01-22

### 新增功能
- **牛牛补贴**: 管理员可给指定用户补贴/扣除属性
  - 命令格式：`牛牛补贴 @用户 长度 硬度 金币`
  - 支持负数参数（倒扣）
  - 硬度最低为0，长度和金币可为负数（欠账）

---

## [v2.0.2] - 2026-01-21 道具系统大改版

### 新增道具
- **小蓝片** (200金币): 下次比划硬度视为100
- **牛牛黑洞** (300金币): 吸取5-15人各3-10%长度
  - 40% 全归使用者
  - 30% 一半喷射给路人
  - 20% 反噬自己
  - 10% 吃撑反喷（所有人反而变长）

### 删除道具
- 巴适得板生长素
- 不灭之握
- 阿姆斯特朗旋风喷射炮

### 道具调整
| 道具 | 原效果 | 新效果 |
|------|--------|--------|
| 巴黎牛家 | +3硬度 (50金币) | +10硬度, -1~10%长度 (200金币) |
| 淬火爪刀 | 额外掠夺10%长度 | 额外掠夺10%长度和10%硬度 |
| 夺牛魔蝌蚪罐头 | 50%夺取/20%清空/30%无效 | 50%夺取全部(长度+硬度)/20%混沌风暴/20%大自爆/10%自爆归零 |
| 赌徒硬币 | 50%翻倍/50%减半 | 50%翻倍/48%减半/1%头等奖(x4)/1%霉运(x-2) |
| 劫富济贫 | 抢15%长度 (300金币) | 抢50%长度+20%硬度 (600金币) |
| 牛牛盾牌 | 直接获得护盾 | 购买时扣除当前50%长度和硬度 |

### 数值调整
- 打胶早期增长上限: 5 → 10cm
- 打胶后期增长范围: 3-6 → 4-12cm

### Bug修复
- 修复开团发起者可能不在团内的问题
- 修复批量购买 `牛牛购买 1 2` 只买1个的问题
- 修复混沌连锁显示 `???` 的问题
- 修复护盾无法抵挡全局事件的问题

### 护盾机制完善
- 混沌风暴个人负面事件检查护盾
- 全局事件 (末日审判/反向天赋/团灭彩票) 检查护盾
- `chaos_tax` 不可被护盾抵挡（核心收益机制）

#### 护盾可抵挡的事件
| 类型 | 事件 | 效果 |
|------|------|------|
| 个人负面 | length_down | 长度-1~15cm |
| 个人负面 | hardness_down | 硬度-1~2 |
| 个人负面 | coin_lose | 失去10~50金币 |
| 个人负面 | length_percent_down | 长度-5~20% |
| 个人负面 | halve | 长度减半 |
| 个人负面 | give_to_random | 送给随机人3~10cm |
| 个人负面 | dark_sacrifice | 牺牲20%长度给别人x3 |
| 个人负面 | reverse_sign | 正负翻转（仅正数时） |
| 全局事件 | doomsday | 最短者归零（最短者可防护） |
| 全局事件 | reverse_talent | 最长最短互换（最长者可防护） |
| 全局事件 | lottery_bomb 95% | 全体-50%（每人单独检查） |
